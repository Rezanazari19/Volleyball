<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Volleyball Scoreboard Pro</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    overflow: hidden;
    height: 100vh;
    width: 100vw;
}

/* HEADER - Compact for landscape */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 16px;
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    z-index: 10;
}

.title {
    font-size: 14px;
    font-weight: 600;
    letter-spacing: 0.5px;
    color: #fff;
    text-transform: uppercase;
}

/* HAMBURGER MENU */
.hamburger {
    width: 24px;
    height: 18px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    cursor: pointer;
    padding: 4px;
}

.hamburger span {
    height: 2px;
    width: 100%;
    background: #fff;
    border-radius: 2px;
    transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
}
.hamburger.active span:nth-child(2) {
    opacity: 0;
}
.hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(5px, -5px);
}

/* MENU PANEL */
.menu {
    position: fixed;
    top: 0;
    right: -280px;
    width: 260px;
    height: 100%;
    background: rgba(15, 23, 42, 0.98);
    backdrop-filter: blur(20px);
    color: white;
    padding: 60px 20px 20px;
    transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 30;
    border-left: 1px solid rgba(255, 255, 255, 0.1);
}

.menu.open { right: 0; }

.menu h3 {
    font-size: 18px;
    margin-bottom: 20px;
    font-weight: 600;
    letter-spacing: 0.5px;
}

.menu button {
    width: 100%;
    padding: 12px 16px;
    margin-top: 12px;
    font-size: 14px;
    font-weight: 500;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
}

.menu button:active {
    background: rgba(255, 255, 255, 0.15);
    transform: scale(0.98);
}

/* OVERLAY */
.overlay {
    position: fixed;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    opacity: 0;
    pointer-events: none;
    transition: 0.3s;
    z-index: 20;
}

.overlay.show {
    opacity: 1;
    pointer-events: auto;
}

/* MAIN SCOREBOARD - Optimized for landscape */
.container {
    display: flex;
    height: calc(100vh - 42px);
    position: relative;
}

.team {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    padding: 10px;
}

.team-blue {
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
}

.team-red {
    background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
}

/* Service indicator */
.service-indicator {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    border: 3px solid rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    animation: pulse 2s infinite;
    opacity: 0;
    transition: opacity 0.3s;
}

#serviceA {
    right: 15px;
}

#serviceB {
    left: 15px;
}

.service-indicator.active {
    opacity: 1;
}

@keyframes pulse {
    0%, 100% { transform: translateY(-50%) scale(1); }
    50% { transform: translateY(-50%) scale(1.1); }
}

.team-name {
    font-size: 16px;
    font-weight: 700;
    letter-spacing: 2px;
    color: rgba(255, 255, 255, 0.9);
    text-transform: uppercase;
    margin-bottom: 8px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.score {
    font-size: 22vw;
    font-weight: 800;
    color: white;
    line-height: 1;
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    margin: 8px 0;
    user-select: none;
}

/* CONTROLS - Horizontal layout for landscape */
.controls {
    display: flex;
    gap: 16px;
    margin-top: 12px;
}

.control-btn {
    width: 60px;
    height: 60px;
    font-size: 32px;
    font-weight: 600;
    border-radius: 50%;
    border: none;
    background: rgba(255, 255, 255, 0.95);
    color: #1e293b;
    cursor: pointer;
    transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
}

.control-btn:active {
    transform: scale(0.92);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}

.control-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

/* WINS BADGE */
.wins {
    position: absolute;
    bottom: 12px;
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(10px);
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

/* FLASH OVERLAY */
.flash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.1s;
}

/* SWAP BUTTON */
.swap-btn {
    position: fixed;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.95);
    color: #1e293b;
    font-size: 13px;
    font-weight: 600;
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    display: none;
    transition: all 0.2s;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    z-index: 5;
}

.swap-btn:active {
    transform: translateX(-50%) scale(0.95);
}

/* DIVIDER */
.divider {
    position: absolute;
    left: 50%;
    top: 0;
    bottom: 0;
    width: 2px;
    background: rgba(255, 255, 255, 0.2);
    transform: translateX(-50%);
}

/* Responsive adjustments */
@media (max-width: 600px) {
    .score {
        font-size: 20vw;
    }
    
    .control-btn {
        width: 50px;
        height: 50px;
        font-size: 28px;
    }
}
</style>
</head>

<body>

<div class="header">
    <div class="title">üèê Volleyball Scoreboard Pro</div>
    <div class="hamburger" id="hamburger" onclick="toggleMenu()">
        <span></span>
        <span></span>
        <span></span>
    </div>
</div>

<div id="menu" class="menu">
    <h3>Settings</h3>
    <button id="resetGameBtn">Hold 5s to Reset Game</button>
    <button id="resetBtn">Hold 10s to Reset All</button>
</div>

<div id="overlay" class="overlay" onclick="toggleMenu()"></div>
<div id="flash" class="flash"></div>

<div class="container">
    <div class="divider"></div>

    <!-- BLUE TEAM -->
    <div class="team team-blue" id="teamA">
        <div class="service-indicator" id="serviceA">üèê</div>
        <div class="team-name" id="nameA">BLUE</div>
        <div id="scoreA" class="score">0</div>

        <div class="controls">
            <button class="control-btn" onclick="changeScore('A',-1)">‚àí</button>
            <button class="control-btn" onclick="changeScore('A',1)">+</button>
        </div>

        <div class="wins">Sets: <span id="winsA">0</span></div>
    </div>

    <!-- RED TEAM -->
    <div class="team team-red" id="teamB">
        <div class="service-indicator" id="serviceB">üèê</div>
        <div class="team-name" id="nameB">RED</div>
        <div id="scoreB" class="score">0</div>

        <div class="controls">
            <button class="control-btn" onclick="changeScore('B',-1)">‚àí</button>
            <button class="control-btn" onclick="changeScore('B',1)">+</button>
        </div>

        <div class="wins">Sets: <span id="winsB">0</span></div>
    </div>

</div>

<button id="swapBtn" class="swap-btn" onclick="swapSides()">‚áÑ Switch Sides</button>

<script>
// Audio Configuration
// Option 1: Use local audio files (place in same directory as HTML)
const AUDIO_CONFIG = {
    useLocal: true, // Set to false to use online sounds
    localFiles: {
        point: 'beep.mp3',      // Point scored sound (works locally and on GitHub Pages if in same folder)
        minus: 'danger.mp3'     // Point deducted sound (works locally and on GitHub Pages if in same folder)
    },
    onlineUrls: {
        point: 'https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3', // Professional beep
        minus: 'https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3'  // Distinctive error/alarm sound
    },
    // Option 3: Use GitHub raw URLs (if hosting on GitHub Pages)
    // Replace 'username' and 'repo' with your actual GitHub username and repository name
    githubUrls: {
        point: 'https://raw.githubusercontent.com/username/repo/main/beep.mp3',
        minus: 'https://raw.githubusercontent.com/username/repo/main/danger.mp3'
    }
};

// Initialize audio elements
const audioPoint = new Audio();
const audioMinus = new Audio();

function loadAudio() {
    if (AUDIO_CONFIG.useLocal) {
        audioPoint.src = AUDIO_CONFIG.localFiles.point;
        audioMinus.src = AUDIO_CONFIG.localFiles.minus;
        console.log('Loading local audio files:', audioPoint.src, audioMinus.src);
    } else {
        audioPoint.src = AUDIO_CONFIG.onlineUrls.point;
        audioMinus.src = AUDIO_CONFIG.onlineUrls.minus;
        console.log('Loading online audio files');
    }
    audioPoint.volume = 0.5;
    audioMinus.volume = 0.5;
    
    // Add error handlers with fallback to online
    audioPoint.addEventListener('error', (e) => {
        console.error('Error loading point sound:', audioPoint.src, e);
        console.log('Falling back to online audio for point sound');
        audioPoint.src = AUDIO_CONFIG.onlineUrls.point;
        audioPoint.load();
    });
    audioMinus.addEventListener('error', (e) => {
        console.error('Error loading minus sound:', audioMinus.src, e);
        console.log('Falling back to online audio for minus sound');
        audioMinus.src = AUDIO_CONFIG.onlineUrls.minus;
        audioMinus.load();
    });
    
    // Preload to reduce delay
    audioPoint.load();
    audioMinus.load();
}

loadAudio();

// Game state
let scoreA = localStorage.getItem("scoreA") ? parseInt(localStorage.getItem("scoreA")) : 0;
let scoreB = localStorage.getItem("scoreB") ? parseInt(localStorage.getItem("scoreB")) : 0;
let winsA = localStorage.getItem("winsA") ? parseInt(localStorage.getItem("winsA")) : 0;
let winsB = localStorage.getItem("winsB") ? parseInt(localStorage.getItem("winsB")) : 0;
let lastScorer = localStorage.getItem("lastScorer") || "A";

let actionLocked = false;
let swapLocked = false;
let resetTimer = null;
let resetGameTimer = null;

updateUI();
updateSwapButton();
updateServiceIndicator();

/* RESET HOLD LOGIC */
const resetBtn = document.getElementById("resetBtn");
const resetGameBtn = document.getElementById("resetGameBtn");

// Reset All (scores + sets)
resetBtn.addEventListener("mousedown", startResetTimer);
resetBtn.addEventListener("touchstart", startResetTimer);
resetBtn.addEventListener("mouseup", cancelResetTimer);
resetBtn.addEventListener("mouseleave", cancelResetTimer);
resetBtn.addEventListener("touchend", cancelResetTimer);

// Reset Game Only (scores, keep sets)
resetGameBtn.addEventListener("mousedown", startResetGameTimer);
resetGameBtn.addEventListener("touchstart", startResetGameTimer);
resetGameBtn.addEventListener("mouseup", cancelResetGameTimer);
resetGameBtn.addEventListener("mouseleave", cancelResetGameTimer);
resetGameBtn.addEventListener("touchend", cancelResetGameTimer);

function startResetTimer(e) {
    e.preventDefault();
    resetBtn.innerText = "Resetting...";
    resetTimer = setTimeout(() => {
        resetAll();
        resetBtn.innerText = "Hold 10s to Reset All";
    }, 10000);
}

function cancelResetTimer() {
    clearTimeout(resetTimer);
    resetBtn.innerText = "Hold 10s to Reset All";
}

function startResetGameTimer(e) {
    e.preventDefault();
    resetGameBtn.innerText = "Resetting...";
    resetGameTimer = setTimeout(() => {
        resetGame();
        resetGameBtn.innerText = "Hold 5s to Reset Game";
    }, 5000);
}

function cancelResetGameTimer() {
    clearTimeout(resetGameTimer);
    resetGameBtn.innerText = "Hold 5s to Reset Game";
}

/* MENU TOGGLE */
function toggleMenu() {
    document.getElementById("menu").classList.toggle("open");
    document.getElementById("hamburger").classList.toggle("active");
    document.getElementById("overlay").classList.toggle("show");
}

/* AUDIO FUNCTIONS */
function playPointSound() {
    audioPoint.currentTime = 0;
    audioPoint.play().catch(e => console.log('Audio play failed:', e));
}

function playMinusSound() {
    // Create three separate audio instances for cleaner beeps
    const beep1 = new Audio(audioMinus.src);
    const beep2 = new Audio(audioMinus.src);
    const beep3 = new Audio(audioMinus.src);
    
    beep1.volume = 0.5;
    beep2.volume = 0.5;
    beep3.volume = 0.5;
    
    beep1.play().catch(e => console.log('Audio play failed:', e));
    
    setTimeout(() => {
        beep2.play().catch(e => console.log('Audio play failed:', e));
    }, 150);
    
    setTimeout(() => {
        beep3.play().catch(e => console.log('Audio play failed:', e));
    }, 300);
}

function victoryTone() {
    // Play point sound twice for victory
    playPointSound();
    setTimeout(() => playPointSound(), 300);
}

/* ANNOUNCEMENTS */
function announce(text) {
    if ('speechSynthesis' in window) {
        const synth = window.speechSynthesis;
        const utter = new SpeechSynthesisUtterance(text);
        utter.rate = 1.1;
        utter.pitch = 1;
        synth.speak(utter);
    }
}

/* FLASH EFFECT */
function flash(color, times = 1) {
    const f = document.getElementById("flash");
    f.style.background = color;
    let count = 0;
    let interval = setInterval(() => {
        f.style.opacity = f.style.opacity == 0 ? 0.3 : 0;
        count++;
        if (count >= times * 2) {
            clearInterval(interval);
            f.style.opacity = 0;
        }
    }, 120);
}

/* LOCK CONTROLS */
function lock() {
    actionLocked = true;
    document.querySelectorAll(".control-btn").forEach(b => b.disabled = true);
    setTimeout(() => {
        actionLocked = false;
        document.querySelectorAll(".control-btn").forEach(b => b.disabled = false);
    }, 1000); // 1 second delay to prevent accidental double-taps
}

/* SERVICE INDICATOR */
function updateServiceIndicator() {
    const serviceA = document.getElementById("serviceA");
    const serviceB = document.getElementById("serviceB");
    
    serviceA.classList.remove("active");
    serviceB.classList.remove("active");
    
    if (lastScorer === "A") {
        serviceA.classList.add("active");
    } else {
        serviceB.classList.add("active");
    }
}

/* SCORE CHANGE */
function changeScore(team, amount) {
    if (actionLocked) return;

    if (team === 'A') {
        if (amount === -1 && scoreA === 0) return;
        scoreA += amount;
    } else {
        if (amount === -1 && scoreB === 0) return;
        scoreB += amount;
    }

    lock();

    const teamName = team === 'A' ? 'Blue' : 'Red';
    const score = team === 'A' ? scoreA : scoreB;

    if (amount === 1) {
        playPointSound();
        flash(team === 'A' ? "#3b82f6" : "#ef4444");
        lastScorer = team;
        updateServiceIndicator();
        
        // Announce after beep finishes (300ms delay)
        setTimeout(() => {
            announce(`${teamName}, ${score}`);
        }, 300);
    } else {
        playMinusSound();
        flash(team === 'A' ? "#3b82f6" : "#ef4444", 2);
        
        // Announce after all three beeps finish (600ms delay)
        setTimeout(() => {
            announce(`${teamName}, ${score}`);
        }, 600);
    }

    checkWinner();
    save();
    updateUI();
    updateSwapButton();
}

/* CHECK WINNER */
function checkWinner() {
    if ((scoreA >= 25 || scoreB >= 25) && Math.abs(scoreA - scoreB) >= 2) {
        const winner = scoreA > scoreB ? 'A' : 'B';
        const winnerName = winner === 'A' ? 'Blue' : 'Red';
        const color = winner === 'A' ? "#3b82f6" : "#ef4444";
        
        if (winner === 'A') {
            winsA++;
        } else {
            winsB++;
        }
        
        flash(color, 3);
        victoryTone();
        announce(`${winnerName} wins the set!`);
        
        setTimeout(() => {
            scoreA = 0;
            scoreB = 0;
            lastScorer = winner; // Winner serves next set
            save();
            updateUI();
            updateSwapButton();
            updateServiceIndicator();
        }, 2000);
    }
}

/* SAVE TO LOCALSTORAGE */
function save() {
    localStorage.setItem("scoreA", scoreA);
    localStorage.setItem("scoreB", scoreB);
    localStorage.setItem("winsA", winsA);
    localStorage.setItem("winsB", winsB);
    localStorage.setItem("lastScorer", lastScorer);
}

/* RESET GAME ONLY (keep sets) */
function resetGame() {
    scoreA = 0;
    scoreB = 0;
    lastScorer = "A";
    save();
    updateUI();
    updateSwapButton();
    updateServiceIndicator();
    toggleMenu();
    announce("Game reset");
}

/* RESET ALL */
function resetAll() {
    scoreA = 0;
    scoreB = 0;
    winsA = 0;
    winsB = 0;
    lastScorer = "A";
    save();
    updateUI();
    updateSwapButton();
    updateServiceIndicator();
    toggleMenu();
    announce("Scoreboard reset");
}

/* SWAP SIDES */
function swapSides() {
    if (swapLocked) return;

    // Swap team names
    const nameA = document.getElementById("nameA").innerText;
    const nameB = document.getElementById("nameB").innerText;
    document.getElementById("nameA").innerText = nameB;
    document.getElementById("nameB").innerText = nameA;

    // Swap team colors/classes
    const teamAEl = document.getElementById("teamA");
    const teamBEl = document.getElementById("teamB");
    
    const hasBlueA = teamAEl.classList.contains("team-blue");
    const hasRedA = teamAEl.classList.contains("team-red");
    
    if (hasBlueA) {
        teamAEl.classList.remove("team-blue");
        teamAEl.classList.add("team-red");
        teamBEl.classList.remove("team-red");
        teamBEl.classList.add("team-blue");
    } else {
        teamAEl.classList.remove("team-red");
        teamAEl.classList.add("team-blue");
        teamBEl.classList.remove("team-blue");
        teamBEl.classList.add("team-red");
    }

    // Swap scores
    const tempScore = scoreA;
    scoreA = scoreB;
    scoreB = tempScore;

    // Swap wins
    const tempWins = winsA;
    winsA = winsB;
    winsB = tempWins;

    // Swap last scorer
    lastScorer = lastScorer === "A" ? "B" : "A";

    save();
    updateUI();
    updateServiceIndicator();
    announce("Sides switched");

    swapLocked = true;
    updateSwapButton();
    setTimeout(() => {
        swapLocked = false;
        updateSwapButton();
    }, 3000);
}

/* UPDATE SWAP BUTTON VISIBILITY */
function updateSwapButton() {
    const btn = document.getElementById("swapBtn");
    if (swapLocked) {
        btn.style.display = "none";
        return;
    }
    // Only show when both scores are 0
    if (scoreA === 0 && scoreB === 0) {
        btn.style.display = "block";
    } else {
        btn.style.display = "none";
    }
}

/* UPDATE UI */
function updateUI() {
    document.getElementById("scoreA").innerText = scoreA;
    document.getElementById("scoreB").innerText = scoreB;
    document.getElementById("winsA").innerText = winsA;
    document.getElementById("winsB").innerText = winsB;
}

// Prevent zoom on double tap
document.addEventListener('dblclick', (e) => {
    e.preventDefault();
}, { passive: false });
</script>

</body>
</html>
